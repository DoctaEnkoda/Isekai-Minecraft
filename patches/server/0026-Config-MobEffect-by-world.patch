From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Bierque Jason <bierquejason@gmail.com>
Date: Wed, 27 Sep 2023 00:35:22 +0200
Subject: [PATCH] Config MobEffect by world


diff --git a/src/main/java/fr/euphilia/tenseimc/TenseiWorldConfig.java b/src/main/java/fr/euphilia/tenseimc/TenseiWorldConfig.java
index 867416f23802003f3012d9e64376a9c262b04de0..e89985c835b133522e45a9a503fdd41247c0181f 100644
--- a/src/main/java/fr/euphilia/tenseimc/TenseiWorldConfig.java
+++ b/src/main/java/fr/euphilia/tenseimc/TenseiWorldConfig.java
@@ -87,6 +87,23 @@ public class TenseiWorldConfig {
         }
     }
 
+    public float entityMinimalHealthPoison = 1.0F;
+    public float entityHealthRegenAmount = 1.0F;
+    public float entityPoisonDegenerationAmount = 1.0F;
+    public float entityWitherDegenerationAmount = 1.0F;
+    public float humanHungerExhaustionAmount = 0.005F;
+    public float humanSaturationRegenAmount = 1.0F;
+    private void effectSettings() {
+        if (TenseiConfig.version < 2) {
+            entityHealthRegenAmount = (float) getDouble("gameplay-mechanics.mob-effects.health-regen-amount", entityHealthRegenAmount);
+            entityMinimalHealthPoison = (float) getDouble("gameplay-mechanics.mob-effects.minimal-health-poison-amount", entityMinimalHealthPoison);
+            entityPoisonDegenerationAmount = (float) getDouble("gameplay-mechanics.mob-effects.poison-degeneration-amount", entityPoisonDegenerationAmount);
+            entityWitherDegenerationAmount = (float) getDouble("gameplay-mechanics.mob-effects.wither-degeneration-amount", entityWitherDegenerationAmount);
+            humanHungerExhaustionAmount = (float) getDouble("gameplay-mechanics.mob-effects.hunger-exhaustion-amount", humanHungerExhaustionAmount);
+            humanSaturationRegenAmount = (float) getDouble("gameplay-mechanics.mob-effects.saturation-regen-amount", humanSaturationRegenAmount);
+        }
+    }
+
     public boolean forceHalloweenSeason = false;
     public float chanceHeadHalloweenOnEntity = 0.25F;
     private void halloweenSettings() {
@@ -137,6 +154,12 @@ public class TenseiWorldConfig {
             set("blocks.chest.open-with-solid-block-on-top", null);
             set("mobs.bee.can-work-at-night", null);
             set("mobs.bee.can-work-in-rain", null);
+            set("gameplay-mechanics.mob-effects.health-regen-amount", null);
+            set("gameplay-mechanics.mob-effects.minimal-health-poison-amount", null);
+            set("gameplay-mechanics.mob-effects.poison-degeneration-amount", null);
+            set("gameplay-mechanics.mob-effects.wither-degeneration-amount", null);
+            set("gameplay-mechanics.mob-effects.hunger-exhaustion-amount", null);
+            set("gameplay-mechanics.mob-effects.saturation-regen-amount", null);
         }
     }
 
diff --git a/src/main/java/net/minecraft/world/effect/HungerMobEffect.java b/src/main/java/net/minecraft/world/effect/HungerMobEffect.java
index 3aad6bd0a1fb7bb3f9b7dab2c10c875864900750..33383b45e641369bb3574b86fedfd06e542f86ca 100644
--- a/src/main/java/net/minecraft/world/effect/HungerMobEffect.java
+++ b/src/main/java/net/minecraft/world/effect/HungerMobEffect.java
@@ -15,7 +15,7 @@ class HungerMobEffect extends MobEffect {
         if (entity instanceof Player) {
             Player entityhuman = (Player) entity;
 
-            entityhuman.causeFoodExhaustion(0.005F * (float) (amplifier + 1), org.bukkit.event.entity.EntityExhaustionEvent.ExhaustionReason.HUNGER_EFFECT); // CraftBukkit - EntityExhaustionEvent
+            entityhuman.causeFoodExhaustion(entity.level().purpurConfig.humanHungerExhaustionAmount * (float) (amplifier + 1), org.bukkit.event.entity.EntityExhaustionEvent.ExhaustionReason.HUNGER_EFFECT); // CraftBukkit - EntityExhaustionEvent // TenseiMC
         }
 
     }
diff --git a/src/main/java/net/minecraft/world/effect/PoisonMobEffect.java b/src/main/java/net/minecraft/world/effect/PoisonMobEffect.java
index f8a8b825d21a7223a9839abda20825702985b7ad..ed1e00f880fde947158ebe1ef337e42fea6e1316 100644
--- a/src/main/java/net/minecraft/world/effect/PoisonMobEffect.java
+++ b/src/main/java/net/minecraft/world/effect/PoisonMobEffect.java
@@ -11,8 +11,8 @@ class PoisonMobEffect extends MobEffect {
     @Override
     public void applyEffectTick(LivingEntity entity, int amplifier) {
         super.applyEffectTick(entity, amplifier);
-        if (entity.getHealth() > 1.0F) {
-            entity.hurt(entity.damageSources().poison, 1.0F);  // CraftBukkit - DamageSource.MAGIC -> CraftEventFactory.POISON
+        if (entity.getHealth() > entity.level().tenseiWorldConfig.entityMinimalHealthPoison) { // TenseiMC
+            entity.hurt(entity.damageSources().poison, entity.level().purpurConfig.entityPoisonDegenerationAmount);  // CraftBukkit - DamageSource.MAGIC -> CraftEventFactory.POISON // TenseiMC
         }
 
     }
diff --git a/src/main/java/net/minecraft/world/effect/RegenerationMobEffect.java b/src/main/java/net/minecraft/world/effect/RegenerationMobEffect.java
index 551b20f86347aeca4824b7a424ad7de7c0ff072e..6babe8ea1450863da390fab8251224b6501eae1e 100644
--- a/src/main/java/net/minecraft/world/effect/RegenerationMobEffect.java
+++ b/src/main/java/net/minecraft/world/effect/RegenerationMobEffect.java
@@ -12,7 +12,7 @@ class RegenerationMobEffect extends MobEffect {
     public void applyEffectTick(LivingEntity entity, int amplifier) {
         super.applyEffectTick(entity, amplifier);
         if (entity.getHealth() < entity.getMaxHealth()) {
-            entity.heal(1.0F, org.bukkit.event.entity.EntityRegainHealthEvent.RegainReason.MAGIC_REGEN); // CraftBukkit
+            entity.heal(entity.level().purpurConfig.entityHealthRegenAmount, org.bukkit.event.entity.EntityRegainHealthEvent.RegainReason.MAGIC_REGEN); // CraftBukkit // TenseiMC
         }
 
     }
diff --git a/src/main/java/net/minecraft/world/effect/SaturationMobEffect.java b/src/main/java/net/minecraft/world/effect/SaturationMobEffect.java
index b994ae09621934df2cdd6a83a7d8ecb44649fb16..4eeb258f3bd76e19a7fc99ffcc5d6889cf0f6503 100644
--- a/src/main/java/net/minecraft/world/effect/SaturationMobEffect.java
+++ b/src/main/java/net/minecraft/world/effect/SaturationMobEffect.java
@@ -23,7 +23,7 @@ class SaturationMobEffect extends InstantenousMobEffect {
             int oldFoodLevel = entityhuman.getFoodData().foodLevel;
             org.bukkit.event.entity.FoodLevelChangeEvent event = CraftEventFactory.callFoodLevelChangeEvent(entityhuman, amplifier + 1 + oldFoodLevel);
             if (!event.isCancelled()) {
-                entityhuman.getFoodData().eat(event.getFoodLevel() - oldFoodLevel, 1.0F);
+                entityhuman.getFoodData().eat(event.getFoodLevel() - oldFoodLevel, entity.level().purpurConfig.humanSaturationRegenAmount); // TenseiMC
             }
 
             ((CraftPlayer) entityhuman.getBukkitEntity()).sendHealthUpdate();
diff --git a/src/main/java/net/minecraft/world/effect/WitherMobEffect.java b/src/main/java/net/minecraft/world/effect/WitherMobEffect.java
index 1f9e0c139988c4c44a26552881647d36965aa4fa..a82375935eaa334afa7ae9e770a853ef2e6d2ed7 100644
--- a/src/main/java/net/minecraft/world/effect/WitherMobEffect.java
+++ b/src/main/java/net/minecraft/world/effect/WitherMobEffect.java
@@ -10,7 +10,7 @@ class WitherMobEffect extends MobEffect {
     @Override
     public void applyEffectTick(LivingEntity entity, int amplifier) {
         super.applyEffectTick(entity, amplifier);
-        entity.hurt(entity.damageSources().wither(), 1.0F);
+        entity.hurt(entity.damageSources().wither(), entity.level().purpurConfig.entityWitherDegenerationAmount); // TenseiMC
     }
 
     @Override
diff --git a/src/main/java/org/purpurmc/purpur/PurpurWorldConfig.java b/src/main/java/org/purpurmc/purpur/PurpurWorldConfig.java
index af9c2fbcb3da068f23ccbaa9e76b3b1a06d68724..17091d0fc991c99daabbb55d9c13fba52db4a76b 100644
--- a/src/main/java/org/purpurmc/purpur/PurpurWorldConfig.java
+++ b/src/main/java/org/purpurmc/purpur/PurpurWorldConfig.java
@@ -155,6 +155,35 @@ public class PurpurWorldConfig {
         chestOpenWithBlockOnTop = getBoolean("blocks.chest.open-with-solid-block-on-top", chestOpenWithBlockOnTop);
     }
 
+    public float entityMinimalHealthPoison = 1.0F;
+    public float entityHealthRegenAmount = 1.0F;
+    public float entityPoisonDegenerationAmount = 1.0F;
+    public float entityWitherDegenerationAmount = 1.0F;
+    public float humanHungerExhaustionAmount = 0.005F;
+    public float humanSaturationRegenAmount = 1.0F;
+    private void effectSettings() {
+        if (TenseiConfig.version < 2) {
+            entityHealthRegenAmount = this.tenseiWorldConfig.entityHealthRegenAmount;
+            entityMinimalHealthPoison = this.tenseiWorldConfig.entityMinimalHealthPoison;
+            entityPoisonDegenerationAmount = this.tenseiWorldConfig.entityPoisonDegenerationAmount;
+            entityWitherDegenerationAmount = this.tenseiWorldConfig.entityWitherDegenerationAmount;
+            humanHungerExhaustionAmount = this.tenseiWorldConfig.humanHungerExhaustionAmount;
+            humanSaturationRegenAmount = this.tenseiWorldConfig.humanSaturationRegenAmount;
+            set("gameplay-mechanics.mob-effects.health-regen-amount", entityHealthRegenAmount);
+            set("gameplay-mechanics.mob-effects.minimal-health-poison-amount", entityMinimalHealthPoison);
+            set("gameplay-mechanics.mob-effects.poison-degeneration-amount", entityPoisonDegenerationAmount);
+            set("gameplay-mechanics.mob-effects.wither-degeneration-amount", entityWitherDegenerationAmount);
+            set("gameplay-mechanics.mob-effects.hunger-exhaustion-amount", humanHungerExhaustionAmount);
+            set("gameplay-mechanics.mob-effects.saturation-regen-amount", humanSaturationRegenAmount);
+        }
+        entityHealthRegenAmount = (float) getDouble("gameplay-mechanics.mob-effects.health-regen-amount", entityHealthRegenAmount);
+        entityMinimalHealthPoison = (float) getDouble("gameplay-mechanics.mob-effects.minimal-health-poison-amount", entityMinimalHealthPoison);
+        entityPoisonDegenerationAmount = (float) getDouble("gameplay-mechanics.mob-effects.poison-degeneration-amount", entityPoisonDegenerationAmount);
+        entityWitherDegenerationAmount = (float) getDouble("gameplay-mechanics.mob-effects.wither-degeneration-amount", entityWitherDegenerationAmount);
+        humanHungerExhaustionAmount = (float) getDouble("gameplay-mechanics.mob-effects.hunger-exhaustion-amount", humanHungerExhaustionAmount);
+        humanSaturationRegenAmount = (float) getDouble("gameplay-mechanics.mob-effects.saturation-regen-amount", humanSaturationRegenAmount);
+    }
+
     public double playerCriticalDamageMultiplier = 1.5D;
     private void playerSettings() {
         if (TenseiConfig.version < 2) {
